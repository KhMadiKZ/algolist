<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0082)file:///E:/olymp/books/unsorted/e-maxx(MAXimal)/e-maxx(new)/lines_intersection.htm -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>MAXimal :: algo :: Нахождение точки пересечения двух прямых</title><link rel="stylesheet" type="text/css" href="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/style.css" tppabs="http://e-maxx.ru/data/style.css"><link rel="stylesheet" type="text/css" href="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/geshi.css" tppabs="http://e-maxx.ru/geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class="main" cellpadding="0" cellspacing="0"><tbody><tr><td class="title" colspan="2"><p>MAXimal</p></td></tr><tr><td class="menu"><ul><li><a href="javascript:if(confirm('http://e-maxx.ru/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://e-maxx.ru/index.php'" tppabs="http://e-maxx.ru/index.php">home</a></li><li><a href="file:///E:/olymp/books/unsorted/e-maxx(MAXimal)/e-maxx(new)/index.htm" tppabs="http://e-maxx.ru/algo/" class="current">algo</a></li><li><a href="javascript:if(confirm('http://e-maxx.ru/wiki/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://e-maxx.ru/wiki/'" tppabs="http://e-maxx.ru/wiki/">wiki</a></li><li><a href="javascript:if(confirm('http://e-maxx.ru/bookz/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://e-maxx.ru/bookz/'" tppabs="http://e-maxx.ru/bookz/">bookz</a></li><li><a href="javascript:if(confirm('http://e-maxx.ru/forum/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://e-maxx.ru/forum/'" tppabs="http://e-maxx.ru/forum/">forum</a></li><li><a href="javascript:if(confirm('http://e-maxx.ru/about.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://e-maxx.ru/about.php'" tppabs="http://e-maxx.ru/about.php">about</a></li></ul></td><td class="content"><p class="algoinfo">прочитано: 8484 раз<br>добавлено: 11 Jun 2008 10:19<br>редактировано: 7 Jul 2009 17:57</p><h1>Точка пересечения прямых</h1><p>Пусть нам даны две прямые, заданные своими коэффициентами <img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/3dfc6bce75a47e2f18110bfc0cbc2c9c.png" tppabs="http://e-maxx.ru/gladtex/cache/3dfc6bce75a47e2f18110bfc0cbc2c9c.png" alt="A_1, B_1, C_1"> и <img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/801642429872199eb69a3144a4e13e60.png" tppabs="http://e-maxx.ru/gladtex/cache/801642429872199eb69a3144a4e13e60.png" alt="A_2, B_2, C_2">. Требуется найти их точку пересечения, или выяснить, что прямые параллельны.</p><p></p><h2>Решение</h2><p>Если две прямые не параллельны, то они пересекаются. Чтобы найти точку пересечения, достаточно составить из двух уравнений прямых систему и решить её:</p><p class="formula"><img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/b72b858f51cbe72eec0f86be8bcf30d2.png" tppabs="http://e-maxx.ru/gladtex/cache/b72b858f51cbe72eec0f86be8bcf30d2.png" alt=" \cases{ A_1 x + B_1 y + C_1 = 0, \cr
A_2 x + B_2[...]"></p><p>Пользуясь формулой Крамера, сразу находим решение системы, которое и будет искомой <b>точкой пересечения</b>:</p><p></p><p class="formula"><img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/ccb31a4901ca56802f0e061bcbad5636.png" tppabs="http://e-maxx.ru/gladtex/cache/ccb31a4901ca56802f0e061bcbad5636.png" alt=" x = - \frac{ \left|\matrix{C_1&amp;B_1 \cr C_2&amp;B_2}\r[...]"><br><img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/4af0695e60dc3385c92e443448acf202.png" tppabs="http://e-maxx.ru/gladtex/cache/4af0695e60dc3385c92e443448acf202.png" alt=" y = - \frac{ \left|\matrix{A_1&amp;C_1 \cr A_2&amp;C_2}\r[...]"></p><p>Если знаменатель нулевой, т.е.</p><p class="formula"><img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/e818b0b0e2900360dc2cf3823ec3caaf.png" tppabs="http://e-maxx.ru/gladtex/cache/e818b0b0e2900360dc2cf3823ec3caaf.png" alt=" \left|\matrix{A_1&amp;B_1 \cr A_2&amp;B_2}\right| = A_1 B[...]"></p>то система решений не имеет (прямые <b>параллельны</b> и не совпадают) или имеет бесконечно много (прямые <b>совпадают</b>). Если необходимо различить эти два случая, надо проверить, что коэффициенты <img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/01b25c10e0e319fcc85b2294475ad26a.png" tppabs="http://e-maxx.ru/gladtex/cache/01b25c10e0e319fcc85b2294475ad26a.png" alt="C"> прямых пропорциональны с тем же коэффициентом пропорциональности, что и коэффициенты <img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/55551d704976ace6373337a3da7b9877.png" tppabs="http://e-maxx.ru/gladtex/cache/55551d704976ace6373337a3da7b9877.png" alt="A"> и <img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/be95612a9afad4a1954d5a88dcdf5ccc.png" tppabs="http://e-maxx.ru/gladtex/cache/be95612a9afad4a1954d5a88dcdf5ccc.png" alt="B">, для чего достаточно посчитать два определителя, если они оба равны нулю, то прямые совпадают:<p></p><p class="formula"><img class="tex" src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/184df12f47b279f8ff93ff40db014691.png" tppabs="http://e-maxx.ru/gladtex/cache/184df12f47b279f8ff93ff40db014691.png" alt=" \left|\matrix{ A_1 &amp; C_1 \cr A_2 &amp; C_2 }\right|, [...]"></p><p></p><h2>Реализация</h2><p></p><pre class="cpp" style="font-family:monospace;"><span class="kw4">struct</span> pt <span class="br0">{</span>
	<span class="kw4">double</span> x, y<span class="sy4">;</span>
<span class="br0">}</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">struct</span> line <span class="br0">{</span>
	<span class="kw4">double</span> a, b, c<span class="sy4">;</span>
<span class="br0">}</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">const</span> <span class="kw4">double</span> EPS <span class="sy1">=</span> <span class="nu19">1e-9</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">double</span> det <span class="br0">(</span><span class="kw4">double</span> a, <span class="kw4">double</span> b, <span class="kw4">double</span> c, <span class="kw4">double</span> d<span class="br0">)</span> <span class="br0">{</span>
	<span class="kw1">return</span> a <span class="sy2">*</span> d <span class="sy2">-</span> b <span class="sy2">*</span> c<span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
<span class="kw4">bool</span> intersect <span class="br0">(</span>line m, line n, pt <span class="sy3">&amp;</span> res<span class="br0">)</span> <span class="br0">{</span>
	<span class="kw4">double</span> zn <span class="sy1">=</span> det <span class="br0">(</span>m.<span class="me1">a</span>, m.<span class="me1">b</span>, n.<span class="me1">a</span>, n.<span class="me1">b</span><span class="br0">)</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">(</span><span class="kw3">abs</span> <span class="br0">(</span>zn<span class="br0">)</span> <span class="sy1">&lt;</span> EPS<span class="br0">)</span>
		<span class="kw1">return</span> <span class="kw2">false</span><span class="sy4">;</span>
	res.<span class="me1">x</span> <span class="sy1">=</span> <span class="sy2">-</span> det <span class="br0">(</span>m.<span class="me1">c</span>, m.<span class="me1">b</span>, n.<span class="me1">c</span>, n.<span class="me1">b</span><span class="br0">)</span> <span class="sy2">/</span> zn<span class="sy4">;</span>
	res.<span class="me1">y</span> <span class="sy1">=</span> <span class="sy2">-</span> det <span class="br0">(</span>m.<span class="me1">a</span>, m.<span class="me1">c</span>, n.<span class="me1">a</span>, n.<span class="me1">c</span><span class="br0">)</span> <span class="sy2">/</span> zn<span class="sy4">;</span>
	<span class="kw1">return</span> <span class="kw2">true</span><span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
<span class="kw4">bool</span> parallel <span class="br0">(</span>line m, line n<span class="br0">)</span> <span class="br0">{</span>
	<span class="kw1">return</span> <span class="kw3">abs</span> <span class="br0">(</span>det <span class="br0">(</span>m.<span class="me1">a</span>, m.<span class="me1">b</span>, n.<span class="me1">a</span>, n.<span class="me1">b</span><span class="br0">)</span><span class="br0">)</span> <span class="sy1">&lt;</span> EPS<span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
<span class="kw4">bool</span> equivalent <span class="br0">(</span>line m, line n<span class="br0">)</span> <span class="br0">{</span>
	<span class="kw1">return</span> <span class="kw3">abs</span> <span class="br0">(</span>det <span class="br0">(</span>m.<span class="me1">a</span>, m.<span class="me1">b</span>, n.<span class="me1">a</span>, n.<span class="me1">b</span><span class="br0">)</span><span class="br0">)</span> <span class="sy1">&lt;</span> EPS
		<span class="sy3">&amp;&amp;</span> <span class="kw3">abs</span> <span class="br0">(</span>det <span class="br0">(</span>m.<span class="me1">a</span>, m.<span class="me1">c</span>, n.<span class="me1">a</span>, n.<span class="me1">c</span><span class="br0">)</span><span class="br0">)</span> <span class="sy1">&lt;</span> EPS
		<span class="sy3">&amp;&amp;</span> <span class="kw3">abs</span> <span class="br0">(</span>det <span class="br0">(</span>m.<span class="me1">b</span>, m.<span class="me1">c</span>, n.<span class="me1">b</span>, n.<span class="me1">c</span><span class="br0">)</span><span class="br0">)</span> <span class="sy1">&lt;</span> EPS<span class="sy4">;</span>
<span class="br0">}</span></pre></td></tr></tbody></table><table width="100%"><tbody><tr><td><p style="text-align:center;"><img src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/valid-html401-blue.png" tppabs="http://www.w3.org/Icons/valid-html401-blue" alt="Valid HTML 4.01 Strict" height="31" width="88"><img src="./MAXimal    algo    Нахождение точки пересечения двух прямых_files/valid-css2-blue.png" tppabs="http://www.w3.org/Icons/valid-css2-blue" alt="Valid CSS 2.1" height="31" width="88"></p></td></tr></tbody></table></body></html>